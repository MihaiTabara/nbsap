{% extends 'layout.html' %}
{% block content %}

{% from 'bits.html' import breadcrumb_items -%}
<ul class="breadcrumb">
  {{ breadcrumb_items([
      (url_for('goals.admin'), "Admin"),
      (url_for('indicators.list_indicators'), "Indicators"),
      (url_for('indicators.view', indicator_id=indicator.id), indicator.name.en)
      ]) }}
</ul>

<div class="btn-toolbar">
  <div class="btn-group">
    <a class="btn btn-primary edit" href="{{url_for('indicators.edit',indicator_id=indicator.id)}}">Edit</a>
  </div>
</div>

<table class="table table-bordered table-striped indicator_view">

  {% set key_targets = ['other_targets'] %}
  {% set key_links = ['links'] %}

  <tbody>
    {% for key in order %}
      {% if key in indicator.keys() %}
      <tr>
        <td class="indicator_field"> {{ transit_dict[key] }} </td>
        <!-- Exceptional case: Other Relevant Aichi Targets-->
        {% if key in key_targets %}
            <td>
            {% for value_element in indicator[key] %}
                {% if loop.last %}
                    <a
                    href="{{url_for('targets.list_targets')}}#target_{{value_element}}">{{value_element}}
                    </a>
                {% else %}
                   <a
                    href="{{url_for('targets.list_targets')}}#target_{{value_element}}">{{value_element}}
                    </a>,
                {% endif %}
            {% endfor %}
            </td>
        <!-- Exceptional case: Related Links -->
        {% elif key in key_links %}
            <td>
                <ul>
                {% for related_link in indicator[key] %}
                    <li><a href="{{related_link.url}}">{{related_link.url_name.en}}</a></li>
                {% endfor %}
                </ul>
            </td>
        {% else %}
        <!-- Exeptional case: Most Relevant Aichi Target -->
            {% if key == 'relevant_target' %}
                <td>
                    <a
                        href="{{url_for('targets.list_targets')}}#target_{{indicator[key]}}">{{indicator[key]}}
                    </a>
                </td>
        <!-- Exeptional case: Goal -->
            {% elif key == 'goal' %}
                <td><a href="{{url_for('goals.list_goals')}}">{{indicator[key]}}</a></td>
        <!-- Exeptional case: Sensitivty, Ease of communication, Validity -->
            {% elif key in ['sensitivity', 'ease_of_communication', 'validity'] %}
              <td> {{ indicator[key] }} </td>
        <!-- Exeptional case: Scale -->
            {% elif key == 'scale' %}
              <td> {{ indicator[key]|join(', ') }} </td>
        <!-- Regular case -->
            {% else %}
              <td> {{ indicator[key].en }} </td>
            {% endif %}
        {% endif %}
      </tr>
      {% endif %}
    {% endfor %}
  </tbody>

</table>

{% endblock content %}
