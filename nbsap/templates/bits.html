{%- macro css_link(filename, media, _external=None) -%}
    <link rel="stylesheet" href="{{ url_for('static', filename=filename, _external=_external) }}"
          {% if media %} media="{{ media }}"{% endif %} />
{%- endmacro %}

{% macro script_src(filename) -%}
    <script src="{{ url_for('static', filename=filename) }}"></script>
{%- endmacro %}

{% macro flash_messages() -%}
  {% for category, message in get_flashed_messages(with_categories=True) %}
    {% set category_cls = 'alert-'+category if category else '' %}
    <p class="alert {{ category_cls }}">{{ message }}</p>
  {% endfor %}
{%- endmacro %}

{% macro breadcrumb_items(crumb_list) -%}
  <li>
    You are here<span class="divider">:</span>
  </li>
  {% for crumb in crumb_list %}
  <li class="{{ "active" if loop.last else "" }}">
    <a href="{{ crumb[0] }}">{{ crumb[1] }}</a>
    {% if not loop.last -%}
      <span class="divider">/</span>
    {%- endif %}
  </li>
  {% endfor %}
{%- endmacro %}

{% macro get_lang() %}
{% endmacro %}

{% macro translate_truncated_markdown(data) -%}
    {% if session.language is defined %}
      {% set lang = session.language[0] %}
    {% elif request is defined %}
      {% set lang = request.accept_languages.best_match(['en', 'fr', 'nl']) %}
    {% else %}
      {% set lang = 'en' %}
    {% endif %}

    {% if lang is none %}
      {% set lang = 'en' %}
    {% endif %}

    {% if data[lang]|markdown == '' %}
      {{ data.en|truncate(length=510, end='...')|markdown }}
    {% else %}
      {{ data[lang]|truncate(length=510, end='...')|markdown }}
    {% endif %}
{%- endmacro %}

{% macro translate_markdown(data) -%}
    {% if session.language is defined %}
      {% set lang = session.language[0] %}
    {% elif request is defined %}
      {% set lang = request.accept_languages.best_match(['en', 'fr', 'nl']) %}
    {% else %}
      {% set lang = 'en' %}
    {% endif %}

    {% if lang is none %}
      {% set lang = 'en' %}
    {% endif %}

    {% if data[lang]|markdown == '' %}
      {{ data.en|markdown }}
    {% else %}
      {{ data[lang]|markdown }}
    {% endif %}
{%- endmacro %}

{% macro translate(data) -%}
    {% if session.language is defined %}
      {% set lang = session.language[0] %}
    {% elif request is defined %}
      {% set lang = request.accept_languages.best_match(['en', 'fr', 'nl']) %}
    {% else %}
      {% set lang = 'en' %}
    {% endif %}

    {% if lang is none %}
      {% set lang = 'en' %}
    {% endif %}

    {% if data[lang] == '' %}
      {{ data.en }}
    {% else %}
      {{ data[lang] }}
    {% endif %}
{%- endmacro %}

{% macro markup_help_button() %}
<div class="markdown_container">
    <div class="markdown_less">
    </div>

    <div class="markdown_all">
        <div class="markdown_text">
            <h3>Markdown Syntax Quick Reference</h3>
            <p>Font Styles</p>
            <table>
                <thead>
                    <th style="width: 150px; text-align: left;"></th>
                    <th></th>
                </thead>

                <tbody>
                    <tr>
                        <td>**Strong**</td>
                        <td>{{'**Strong**'|markdown}}</td>
                    </tr>
                    <tr>
                        <td>_Italic_</td>
                        <td>{{'_Italic_'|markdown}}</td>
                    </tr>
                    <tr>
                        <td>`Inline Code`</td>
                        <td>{{'`Inline Code`'|markdown}}</td>
                    </tr>
               </tbody>
            </table>

            <p>Lists</p>
            <table>
                <thead>
                    <th style="width: 150px; text-align: left;"></th>
                    <th></th>
                </thead>

                <tbody>
                    <tr>
                        <td>
                            * Item1
                            <br/>
                            * Item2
                        </td>
                        <td>
                            {{'* Item1'|markdown}}
                            {{'* Item2'|markdown}}
                        </td>
                    </tr>
               </tbody>
            </table>

            <p>Headings</p>
            <table>
                <thead>
                    <th style="width: 150px; text-align: left;"></th>
                    <th></th>
                </thead>

                <tbody>
                    <tr>
                        <td>
                            #### Fourth level heading
                        </td>
                        <td>
                            {{'#### Fourth level heading'|markdown}}
                        </td>
                    </tr>
                    <tr>
                        <td>
                            ##### Fifth level heading
                        </td>
                        <td>
                            {{'##### Fifth level heading'|markdown}}
                        </td>
                    </tr>
                </tbody>
            </table>

            <p>Links</p>
            <table>
                <thead>
                    <th style="width: 150px; text-align: left;"></th>
                    <th></th>
                </thead>

                <tbody>
                    <tr>
                        <td>
                            [Foo](http://foo.bar)
                        </td>
                        <td>
                            {{'[Foo](http://foo.bar)'|markdown}}
                        </td>
                    </tr>
               </tbody>
            </table>

            <p>More info
                <a href="http://daringfireball.net/projects/markdown/syntax">here</a>.
            </p>
        </div>
    </div>
</div>
{% endmacro %}

{% macro markdown_preview() %}
<div class="modal hide" id="preview">
  <div class="modal-header">
    <a class="close" data-dismiss="modal">×</a>
    <h3>{{_('Preview')}}</h3>
  </div>
  <div class="modal-body">
  </div>
  <div class="modal-footer">
    <a class="btn" data-dismiss="modal">{{_('Close')}}</a>
  </div>
</div>

<a class="btn preview" data-toggle="modal" href="#preview">
  {{_('Preview')}}
</a>
{% endmacro %}

{% macro markdown_help() %}
<div class="modal hide" id="help">
  <div class="modal-header">
    <a class="close" data-dismiss="modal">×</a>
    <h3>{{_('Markdown Cheat Sheet')}}</h3>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="span4">
        <p>{{_('Headers')}}</p>
        <pre>{{_('# This is an &lt;h1&gt; tag')}}<br>{{_('## This is an &lt;h2&gt; tag')}}<br>{{_('###### This is an &lt;h6&gt; tag')}}</pre>
        <p>{{_('Text styles')}}</p>
        <pre>{{_('*This text will be italic*')}}<br>{{_('_This will also be italic_')}}<br>{{_('**This text will be bold**')}}<br>{{_('__This will also be bold__')}}<br><br>{{_('*You **can** combine them*')}}</pre>
        <p>{{_('Links')}}</p>
        <pre>[{{_('Link name')}}]({{_('http://example.com')}})</pre>
      </div>
      <div class="span4">
        <p>{{_('Ordered List')}}</p>
        <pre>1. {{_('Item')}} 1<br>2. {{_('Item')}} 2<br>3. {{_('Item')}} 3<br>   * {{_('Item')}} 3a<br>   * {{_('Item')}} 3b</pre>
        <p>{{_('Unordered List')}}</p>
        <pre>* {{_('Item')}} 1<br>* {{_('Item')}} 2<br>  * {{_('Item')}} 2a<br>  * {{_('Item')}} 2b</pre>
        <p>{{_('More info')}}</p>
        <p><a href="http://daringfireball.net/projects/markdown/syntax">http://daringfireball.net/projects/markdown/syntax</a></p>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal">{{_('Close')}}</button>
  </div>
</div>

<a class="btn help" data-toggle="modal" href="#help">
  <i class="icon-question-sign"></i>
</a>
{% endmacro %}
